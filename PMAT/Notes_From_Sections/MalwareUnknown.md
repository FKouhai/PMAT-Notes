# MalwareUnknown.exe

## File hash and VT Analysis


| HASH  | Filename   |
|---	|---		 |
|92730427321a1c4ccfc0d0580834daef98121efa9bb8963da332bfd6cf1fda8a |\*Malware.Unknown.exe.malz|   
| 1d8562c0adcaee734d63f7baaca02f7c  	|  \*Malware.Unknown.exe.malz |   


### Virus Total Analysis

43/65 AV vendors flag the fingerprint as malware
[VT complete report](https://www.virustotal.com/gui/file/92730427321a1c4ccfc0d0580834daef98121efa9bb8963da332bfd6cf1fda8a/community)

### Basic Static Analysis

|Program | Output |
|---|---|
|FLOSS|jjjj <br /> cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s" <br /> http://ssl-6582datamanager.helpdeskbros.local/favicon.ico <br /> C:\\Users\\Public\\Documents\\CR433101.dat.exe <br /> Mozilla/5.0 <br /> http://huskyhacks.dev <br /> ping 1.1.1.1 -n 1 -w 3000 > Nul & C:\\Users\\Public\\Documents\\CR433101.dat.exe <br /> open |

#### Windows API Calls
- CreateProcessW
- GetCurrentProcessId
- GetCurrentThreadId
- TerminateProcess
- ShellExecuteW
- URLDownloadToFileW
- InternetOpenW
- InternetOpenUrlW


### Basic Dynamic Analysis

After detonating the malware, we see on wireshark the following request

![[Pasted image 20211212125556.png]]

After running procmon

![[Pasted image 20211213205123.png]]

We noticed that our observations in our static analysis were correct and it indeed creates a file in C:\Users\Public\Documents\CR433101.dat.exe

![[Pasted image 20211213210052.png]]

Potentially this malware downloads an exe file which could potentially be a backdoor or another kind of malware

After applying the following filter in procmon and having stopped inetsim on remmnux

![[Pasted image 20211213211219.png]]

We see that indeed the malware has a killswitch that when it can reach to that url it removes itself from the FS

![[Pasted image 20211213211259.png]]

The malware runs the following code
```powrshell
cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "C:\Users\birdman\Desktop\Malware.Unknown.exe"
```

We can assume that the program execution flow is as follows

- If URL exists
	- Download favicon.ico
	- Writes into the filesystem CR433101.dat.exe
	- Run favicon.ico
- If URL doesnt exist
	- Removes from disk
	- Doesnt run

As a provisional name for this malware we can name it 

DropperDownloandFromURL(DDFURL), since what it basically does is fetching a file from the internet and potentially runs it